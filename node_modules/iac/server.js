const net = require('net')
const iac = require('.')

net
  .createServer(sock => {
    // Do not use `sock.setEncoding` at any point if using `iac.on(sock)`

    // Handlers...
    iac
      .on(sock, iac.will.naws, () => console.log(`Remote will NAWS`))
      .on(sock, iac.wont.naws, () => console.log(`Remote wont NAWS`))
      .on(sock, iac.sb.naws, (width, height) => {
        // Note encoding is operation-specific
        console.log(`Remote terminal size is ${width}x${height}`)
      })

    // Ask socket to negotiate window size
    sock.write(iac.do.naws)
  })
  .listen(3000)